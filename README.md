# 清除Excel中的自定义样式

通过 [JSZip](https://github.com/Stuk/jszip) 解压 xlsx 文件，然后删除其中 styles.xml、workbook.xml 文件中多余的内容。

## 使用方法

- 将文件夹复制到本地，用浏览器打开 index.html 即可直接使用。
- 或者，访问 [在线地址](https://luckycat.xyz/tools/excel-zip/) 来使用，处理过程中不会上传你的文件。


## 说明：

- 多余的自定义样式，主要是在合并 Excel 文件时产生的，从一个文件带入另一个文件中，就像病毒一样。
- 这些样式可能来自于第三方软件生成的工作表，因命名不规范等原因不能被 Excel 自动清除。
- 每次合并工作表都可能造成这些样式的数量翻倍。
- 当样式数量大于 2<sup>16</sup> 也就是 65536 个时，就会因为单元格格式太多，无法继续编辑。
- 该页面的所有计算都是在本地完成的，不会上传你的文件。
- 文件需要是 xlsx 格式，如果是早期版本的 xls 文件，请先在 Excel 中另存为 xlsx 格式。
- 在 Chrome 浏览器中可以同时处理多个文件，其他浏览器例如 IE 不支持同时下载多个文件，只能一个一个处理。

## 处理过程：

- 使用 zip 解压文件。
- 删除 xl 文件夹下 styles.xml 等文件中的 &lt;cellStyles&gt;...&lt;/cellStyles&gt; 等标签内的所有内容。
- 重新用 zip 打包成 xlsx 文件，以【下载】的方式返回新文件。
